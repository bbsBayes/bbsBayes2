<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generate regional trends — generate_trends • bbsBayes2</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate regional trends — generate_trends"><meta name="description" content="Generates trends for continent and strata and optionally for countries,
states/provinces, or BCRs from analyses run on the stratifications that
support these composite regions. Calculates the geometric mean annual changes
in population size for composite regions."><meta property="og:description" content="Generates trends for continent and strata and optionally for countries,
states/provinces, or BCRs from analyses run on the stratifications that
support these composite regions. Calculates the geometric mean annual changes
in population size for composite regions."><meta property="og:image" content="https://bbsbayes.github.io/bbsBayes2/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bbsBayes2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/bbsBayes2.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bbsBayes/bbsBayes2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generate regional trends</h1>
      <small class="dont-index">Source: <a href="https://github.com/bbsBayes/bbsBayes2/blob/v.1.1.3.1/R/generate-trends.R" class="external-link"><code>R/generate-trends.R</code></a></small>
      <div class="d-none name"><code>generate_trends.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generates trends for continent and strata and optionally for countries,
states/provinces, or BCRs from analyses run on the stratifications that
support these composite regions. Calculates the geometric mean annual changes
in population size for composite regions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">generate_trends</span><span class="op">(</span></span>
<span>  <span class="va">indices</span>,</span>
<span>  min_year <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_year <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quantiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.25</span>, <span class="fl">0.75</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>  slope <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  gam <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prob_decrease <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prob_increase <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hpdi <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  export_full_posterior <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-indices">indices<a class="anchor" aria-label="anchor" href="#arg-indices"></a></dt>
<dd><p>List. Indices generated by <code><a href="generate_indices.html">generate_indices()</a></code>.</p></dd>


<dt id="arg-min-year">min_year<a class="anchor" aria-label="anchor" href="#arg-min-year"></a></dt>
<dd><p>Numeric. Minimum year to use. Default (<code>NULL</code>) uses first
year in data.</p></dd>


<dt id="arg-max-year">max_year<a class="anchor" aria-label="anchor" href="#arg-max-year"></a></dt>
<dd><p>Numeric. Maximum year to use. Default (<code>NULL</code>) uses first
year in data.</p></dd>


<dt id="arg-quantiles">quantiles<a class="anchor" aria-label="anchor" href="#arg-quantiles"></a></dt>
<dd><p>Numeric vector. Quantiles to be sampled from the posterior
distribution. Defaults to <code>c(0.025, 0.05, 0.25, 0.5, 0.75, 0.95, 0.975)</code>.</p></dd>


<dt id="arg-slope">slope<a class="anchor" aria-label="anchor" href="#arg-slope"></a></dt>
<dd><p>Logical. Whether to calculate an alternative trend metric, the
slope of a log-linear regression through the annual indices. Default
<code>FALSE</code>, which estimates the trend as the geometric mean annual rate of
change between <code>min_year</code> and <code>max_year</code>. This is the end-point definition
of trend that only directly incorporates information from the two years, and
therefore closely tracks the annual population fluctuations in those
particular years. Conceptually, this metric of trend tracks the difference
between the two years. If <code>TRUE</code>, trend represents the slope of a linear
regression through the log-transformed annual indices of abundance for all
years between <code>min_year</code> and <code>max_year</code>. This definition of trend is less
sensitive to the particular annual fluctuations of a given <code>min_year</code> and
<code>max_year</code>. Either metric may be more or less appropriate given the user's
desired inference. The appropriate choice of metric may also depend on the
model and the <code>alternate_n</code> choice made in <code>generate_indices</code>. For example
if the fitted model was one of the "gamye" alternatives, and the
<code>alternate_n = "nsmooth"</code>, then the default <code>slope = FALSE</code> option will
represent the end-point difference of the smooth component, which already
excludes the annual fluctuations and so has similar inferential properties as
the <code>slope = TRUE</code> option from the "first_diff" model.</p></dd>


<dt id="arg-gam">gam<a class="anchor" aria-label="anchor" href="#arg-gam"></a></dt>
<dd><p>Logical. New in version 1.1.2. Optional trend calculation using
end-point trends derived from posterior distribution of GAM-based smooths of
each posterior draw of the estimated annual indices. Requires the output from
generate_indices(., gam_smooth = TRUE).</p></dd>


<dt id="arg-prob-decrease">prob_decrease<a class="anchor" aria-label="anchor" href="#arg-prob-decrease"></a></dt>
<dd><p>Numeric vector. Percent-decrease values for which to
optionally calculate the posterior probabilities (see Details). Default is
<code>NULL</code> (not calculated). Can range from 0 to 100.</p></dd>


<dt id="arg-prob-increase">prob_increase<a class="anchor" aria-label="anchor" href="#arg-prob-increase"></a></dt>
<dd><p>Numeric vector. Percent-increase values for which to
optionally calculate the posterior probabilities (see Details). Default is
<code>NULL</code> (not calculated). Can range from 0 to Inf.</p></dd>


<dt id="arg-hpdi">hpdi<a class="anchor" aria-label="anchor" href="#arg-hpdi"></a></dt>
<dd><p>Logical. Should credible intervals and limits be calculated using
highest posterior density intervals instead of simple quantiles of the
posterior distribution. Default is <code>FALSE</code>. these intervals are often a
better descriptor of skewed posterior distributions, such as the predicted
mean counts that the indices represent.
Note hpd intervals are not stable for small percentages of the posterior
distribution, and so <code>hpdi = TRUE</code> is ignored for <code>quantiles</code> values
between 0.33 and 0.67 (i.e., if the <code>quantiles</code> value defines a limit for
a centered hpd interval that would include &lt; 33% of the
posterior distribution).</p></dd>


<dt id="arg-export-full-posterior">export_full_posterior<a class="anchor" aria-label="anchor" href="#arg-export-full-posterior"></a></dt>
<dd><p>Logical. Default FALSE. If TRUE, the output list
includes a tibble that contains the full posterior distribution of every
trend estimate</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing</p><ul><li><p><code>trends</code> - data frame of calculated population trends, one row for each
region in the input <code>indices</code></p></li>
<li><p><code>meta_data</code> - meta data defining the analysis</p></li>
<li><p><code>meta_strata</code> - data frame listing strata meta data</p></li>
<li><p><code>raw_data</code> - data frame of summarized counts</p></li>
<li><p><code>trends_full_posterior</code> - tibble of trends, region names, and full
posterior distribution of every trend estimate. Can be used for formal
comparisons of differences in trends between time-periods, regions, etc.</p></li>
</ul><p><strong><code>trends</code></strong> contains the following columns:</p><ul><li><p><code>start_year</code> - First year of the trend</p></li>
<li><p><code>end_year</code> - Last year of the trend</p></li>
<li><p><code>region</code> - Region name</p></li>
<li><p><code>region_type</code> - Type of region</p></li>
<li><p><code>strata_included</code> - Strata <em>potentially</em> included in the annual index
calculations</p></li>
<li><p><code>strata_excluded</code> - Strata <em>potentially</em> excluded from the annual index
calculations because they have no observations of the species in the first
part of the time series, see arguments <code>max_backcast</code> and <code>start_year</code></p></li>
<li><p><code>trend</code> - Estimated median annual percent change over the trend
time-period according to end point comparison of annual indices for the
<code>start_year</code> and the <code>end_year</code></p></li>
<li><p><code>trend_q_XXX</code> - Trend estimates by different quantiles</p></li>
<li><p><code>percent_change</code> - Median overall estimate percent change over the trend
time-period</p></li>
<li><p><code>percent_change_q_XXX</code> - Percent change by different quantiles</p></li>
<li><p><code>slope_trend</code> - Estimated median annual percent change over the trend
time-period, according to the slope of a linear regression through the
log-transformed annual indices. (Only if <code>slope = TRUE</code>)</p></li>
<li><p><code>slope_trend_q_XXX</code> - Slope-based trend estimates by different quantiles.
(Only if <code>slope = TRUE</code>)</p></li>
<li><p><code>width_of_95_percent_credible_interval</code> - Width (in percent/year) of the
credible interval on the trend calculation. Calculated for the widest
credible interval requested in via <code>quantiles</code>. Default is 95 percent CI
(i.e., <code>trend_q_0.975</code> - <code>trend_q_0.025</code>)</p></li>
<li><p><code>width_of_95_percent_credible_interval_slope</code> - Width (in percent/year)
of the credible interval on the slope-based trend calculation. Calculated
for the widest credible interval requested in via <code>quantiles</code>. Default is
95 percent CI (i.e., <code>slope_trend_q_0.975</code> - <code>slope_trend_q_0.025</code>). (Only
if <code>slope = TRUE</code>)</p></li>
<li><p><code>prob_decrease_XX_percent</code> - Proportion of the posterior distribution of
<code>percent_change</code> that is below the percentage values in
<code>prob_decrease</code> (if non-<code>Null</code>)</p></li>
<li><p><code>prob_increase_XX_percent</code> - Proportion of the posterior distribution of
<code>percent_change</code> that is above tthe percentage values in
<code>prob_increase</code> (if non-<code>Null</code>)</p></li>
<li><p><code>rel_abundance</code> - Mean annual index value across all years. An estimate
of the average relative abundance of the species in the region. Can be
interpreted as the predicted average count of the species in an average
year on an average route by an average observer, for the years, routes, and
observers in the existing data</p></li>
<li><p><code>obs_rel_abundance</code> - Mean observed annual count of birds across all
routes and all years. An alternative estimate of the average relative
abundance of the species in the region. For composite regions (i.e.,
anything other than stratum-level estimates) this average count is
calculated as an area-weighted average across all strata included.</p></li>
<li><p><code>n_routes</code> - Number of BBS routes that contributed data for this
species and region for all years in the selected time-series, i.e., all
years since <code>start_year</code></p></li>
<li><p><code>mean_n_routes</code> - Mean number of BBS routes that contributed data for
this species, region, and year</p></li>
<li><p><code>n_strata_included</code> - The number of strata included in the region</p></li>
<li><p><code>backcast_flag</code> - Approximate annual average proportion of the covered
species range that is free of extrapolated population trajectories. e.g.,
if 1.0, data cover full time-series; if 0.75, data cover 75 percent of
time-series. Only calculated if <code>max_backcast != NULL</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The posterior probabilities can be calculated for a percent-decrease
(<code>prob_decrease</code>) and/or percent-increase (<code>prob_increase</code>) if desired.
These calculate the probability that the population has decreased/increased
by at least the amount specified.</p>
<p>For example, a <code>prob_increase = 100</code> would result in the calculation of the
probability that the population has increased by more than 100% (i.e.,
doubled) over the period of the trend.</p>
<p>Alternatively, a <code>prob_decrease = 50</code> would result in the calculation of
the probability that the population has decreased by more than 50% (i.e.,
less than half of the population remains) over the period of the trend.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other indices and trends functions:
<code><a href="generate_indices.html">generate_indices()</a></code>,
<code><a href="plot_geofacet.html">plot_geofacet()</a></code>,
<code><a href="plot_indices.html">plot_indices()</a></code>,
<code><a href="plot_map.html">plot_map()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Using the example model for Pacific Wrens...</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate the continental and stratum indices</span></span></span>
<span class="r-in"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_indices.html">generate_indices</a></span><span class="op">(</span><span class="va">pacific_wren_model</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Processing region continent</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Processing region stratum</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Now, generate the trends</span></span></span>
<span class="r-in"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu">generate_trends</span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use the slope method</span></span></span>
<span class="r-in"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu">generate_trends</span><span class="op">(</span><span class="va">i</span>, slope <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate probability of the population declining by 50%</span></span></span>
<span class="r-in"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu">generate_trends</span><span class="op">(</span><span class="va">i</span>, prob_decrease <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Brandon P.M. Edwards, Adam C. Smith, Steffi LaZerte.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

