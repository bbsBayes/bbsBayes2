<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Stratify and filter Breeding Bird Survey data — stratify • bbsBayes2</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Stratify and filter Breeding Bird Survey data — stratify"><meta name="description" content="Assign count data to strata and filter by species of interest. Routes are
assigned to strata based on their geographic location and the stratification
specified by the user. Species are filtered by matching English, French or
Scientific names to those in the BBS species data (see search_species() for
a flexible search to identify correct species names)."><meta property="og:description" content="Assign count data to strata and filter by species of interest. Routes are
assigned to strata based on their geographic location and the stratification
specified by the user. Species are filtered by matching English, French or
Scientific names to those in the BBS species data (see search_species() for
a flexible search to identify correct species names)."><meta property="og:image" content="https://bbsbayes.github.io/bbsBayes2/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bbsBayes2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/bbsBayes2.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bbsBayes/bbsBayes2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Stratify and filter Breeding Bird Survey data</h1>
      <small class="dont-index">Source: <a href="https://github.com/bbsBayes/bbsBayes2/blob/main/R/stratify.R" class="external-link"><code>R/stratify.R</code></a></small>
      <div class="d-none name"><code>stratify.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Assign count data to strata and filter by species of interest. Routes are
assigned to strata based on their geographic location and the stratification
specified by the user. Species are filtered by matching English, French or
Scientific names to those in the BBS species data (see <code><a href="search_species.html">search_species()</a></code> for
a flexible search to identify correct species names).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stratify</span><span class="op">(</span></span>
<span>  <span class="va">by</span>,</span>
<span>  <span class="va">species</span>,</span>
<span>  strata_custom <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  combine_species_forms <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  release <span class="op">=</span> <span class="fl">2024</span>,</span>
<span>  sample_data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_omitted <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>Character. Stratification type. Either an established type, one of
"prov_state", "bcr", "latlong", "bbs_cws", "bbs_usgs", or a custom name
(see <code>strata_custom</code> for details).</p></dd>


<dt id="arg-species">species<a class="anchor" aria-label="anchor" href="#arg-species"></a></dt>
<dd><p>Character. Bird species of interest. Can be specified by
English, French, or Scientific names, or AOU code. Use <code><a href="search_species.html">search_species()</a></code>
for loose matching to find the exact name/code needed.</p></dd>


<dt id="arg-strata-custom">strata_custom<a class="anchor" aria-label="anchor" href="#arg-strata-custom"></a></dt>
<dd><p>(<code>sf</code>) Data Frame. Data frame
of modified existing stratification, or a <code>sf</code> spatial data frame with
polygons defining the custom stratifications. See Details.</p></dd>


<dt id="arg-combine-species-forms">combine_species_forms<a class="anchor" aria-label="anchor" href="#arg-combine-species-forms"></a></dt>
<dd><p>Logical. Whether to combine ambiguous species
forms. Default <code>TRUE</code>. See Details.</p></dd>


<dt id="arg-release">release<a class="anchor" aria-label="anchor" href="#arg-release"></a></dt>
<dd><p>Numeric. Which yearly release to use, 2022 (including data
through 2021 field season) or 2020 (including data through 2019). Default
2022.</p></dd>


<dt id="arg-sample-data">sample_data<a class="anchor" aria-label="anchor" href="#arg-sample-data"></a></dt>
<dd><p>Logical. Use sample data (just Pacific Wrens). Default
<code>FALSE</code>.</p></dd>


<dt id="arg-return-omitted">return_omitted<a class="anchor" aria-label="anchor" href="#arg-return-omitted"></a></dt>
<dd><p>Logical. Whether or not to return a data frame of
route-years which were omitted during stratification as they did not
overlap with any stratum. For checking and troubleshooting. Default
<code>FALSE</code>.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>Logical. Suppress progress messages? Default <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List of (meta) data.</p><ul><li><p><code>meta_data</code> - meta data defining the analysis</p></li>
<li><p><code>meta_strata</code> - data frame listing strata names and area for
all strata relevant to the data (i.e. some may have been removed due to
lack of count data). Contains at least <code>strata_name</code> (the label of the
stratum), and <code>area_sq_km</code> (area of the stratum).</p></li>
<li><p><code>birds_strata</code> - data frame of stratified count-level data filtered by
species</p></li>
<li><p><code>routes_strata</code> - data frame of stratified route-level data filtered by
species</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>To define a custom subset of an existing stratification, specify the
stratification in <code>by</code> (e.g., "bbs_cws") and then supply a subset of
<code>bbs_strata[["bbc_cws"]]</code> to <code>strata_custom</code> (see examples).</p>
<p>To define a completely new custom stratification, specify the name you
would like use in <code>by</code> (e.g., "east_west_divide") and then supply a spatial
data frame with polygons identifying the different strata to
<code>strata_custom</code>. Note that this data must have a column called exactly
<code>strata_name</code> which names all the strata contained (see examples). This
column must also be of class character not numeric or factor.</p>
<p>If <code>combine_species_forms</code> is <code>TRUE</code> (default), species with multiple forms
(e.g., "unid. Dusky Grouse / Sooty Grouse") are included in overall species
groupings (i.e., "unid." are combined with "Dusky Grouse" and "Sooty
Grouse" into "Blue Grouse (Dusky/Sooty)"). If the user wishes to keep the
forms separate, <code>combine_species_forms</code> can be set to <code>FALSE</code>. See the data
frame <code>species_forms</code>, for which species are set to be combined with which
other species.</p>
<p>See <code>vignette("stratification", package = "bbsBayes2")</code> and the article
<a href="https://bbsBayes.github.io/bbsBayes2/articles/custom_stratification.html" class="external-link">custom stratification</a>
for more details.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Data prep functions:
<code><a href="prepare_data.html">prepare_data</a>()</code>,
<code><a href="prepare_model.html">prepare_model</a>()</code>,
<code><a href="prepare_spatial.html">prepare_spatial</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Sample Data - USGS BBS strata</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">stratify</span><span class="op">(</span>by <span class="op">=</span> <span class="st">"bbs_usgs"</span>, sample_data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 'bbs_usgs' (standard) stratification</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using sample BBS data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using species Pacific Wren (sample data)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering to species Pacific Wren (7221)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Stratifying data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Renaming routes...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Full data - species and stratification</span></span></span>
<span class="r-in"><span><span class="co"># Use `search_species()` to get correct species name</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stratify by CWS BBS strata</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">stratify</span><span class="op">(</span>by <span class="op">=</span> <span class="st">"bbs_cws"</span>, species <span class="op">=</span> <span class="st">"Common Loon"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 'bbs_cws' (standard) stratification</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading BBS data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering to species Common Loon (70)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Stratifying data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Combining BCR 7 and NS and PEI...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Renaming routes...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use use English, French, Scientific, or AOU codes for species names</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">stratify</span><span class="op">(</span>by <span class="op">=</span> <span class="st">"bbs_cws"</span>, species <span class="op">=</span> <span class="st">"Plongeon huard"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 'bbs_cws' (standard) stratification</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading BBS data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering to species Common Loon (70)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Stratifying data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Combining BCR 7 and NS and PEI...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Renaming routes...</span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">stratify</span><span class="op">(</span>by <span class="op">=</span> <span class="st">"bbs_cws"</span>, species <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 'bbs_cws' (standard) stratification</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading BBS data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering to species Common Loon (70)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Stratifying data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Combining BCR 7 and NS and PEI...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Renaming routes...</span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">stratify</span><span class="op">(</span>by <span class="op">=</span> <span class="st">"bbs_cws"</span>, species <span class="op">=</span> <span class="st">"Gavia immer"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 'bbs_cws' (standard) stratification</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading BBS data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering to species Common Loon (70)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Stratifying data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Combining BCR 7 and NS and PEI...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Renaming routes...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stratify by Bird Conservation Regions</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">stratify</span><span class="op">(</span>by <span class="op">=</span> <span class="st">"bcr"</span>, species <span class="op">=</span> <span class="st">"Great Horned Owl"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 'bcr' (standard) stratification</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading BBS data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering to species Great Horned Owl (3750)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Stratifying data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Renaming routes...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stratify by CWS BBS strata</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">stratify</span><span class="op">(</span>by <span class="op">=</span> <span class="st">"bbs_cws"</span>, species <span class="op">=</span> <span class="st">"Canada Jay"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 'bbs_cws' (standard) stratification</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading BBS data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering to species Canada Jay (4840)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Stratifying data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Combining BCR 7 and NS and PEI...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Renaming routes...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stratify by State/Province/Territory only</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">stratify</span><span class="op">(</span>by <span class="op">=</span> <span class="st">"prov_state"</span>, species <span class="op">=</span> <span class="st">"Common Loon"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 'prov_state' (standard) stratification</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading BBS data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering to species Common Loon (70)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Stratifying data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Renaming routes...</span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">stratify</span><span class="op">(</span>by <span class="op">=</span> <span class="st">"prov_state"</span>, species <span class="op">=</span> <span class="st">"Plongeon huard"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 'prov_state' (standard) stratification</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading BBS data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering to species Common Loon (70)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Stratifying data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Renaming routes...</span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">stratify</span><span class="op">(</span>by <span class="op">=</span> <span class="st">"prov_state"</span>, species <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 'prov_state' (standard) stratification</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading BBS data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering to species Common Loon (70)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Stratifying data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Renaming routes...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stratify by blocks of 1 degree of latitude X 1 degree of longitude</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">stratify</span><span class="op">(</span>by <span class="op">=</span> <span class="st">"latlong"</span>, species <span class="op">=</span> <span class="st">"Snowy Owl"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 'latlong' (standard) stratification</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading BBS data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering to species Snowy Owl (3760)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Stratifying data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Renaming routes...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Omitting 81/124,900 route-years that do not match a stratum.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     To see omitted routes use `return_omitted = TRUE` (see ?stratify)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check routes omitted by stratification</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">stratify</span><span class="op">(</span>by <span class="op">=</span> <span class="st">"latlong"</span>, species <span class="op">=</span> <span class="st">"Snowy Owl"</span>, return_omitted <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 'latlong' (standard) stratification</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading BBS data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering to species Snowy Owl (3760)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Stratifying data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Renaming routes...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Omitting 81/124,900 route-years that do not match a stratum.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Returning omitted routes.</span>
<span class="r-in"><span><span class="va">s</span><span class="op">[[</span><span class="st">"routes_omitted"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 81 × 11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     year strata_name country state     route route_name latitude longitude   bcr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">1</span>988 <span style="color: #BB0000;">NA</span>          US      CALIFORN… 14-1… SANTA CRU…     34.0    -<span style="color: #BB0000;">120.</span>     32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">1</span>987 <span style="color: #BB0000;">NA</span>          US      FLORIDA   25-83 KEY WEST       24.7     -<span style="color: #BB0000;">81.2</span>    31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">1</span>999 <span style="color: #BB0000;">NA</span>          US      FLORIDA   25-1… SUGARLOAF…     24.7     -<span style="color: #BB0000;">81.2</span>    31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">2</span>002 <span style="color: #BB0000;">NA</span>          US      FLORIDA   25-1… SUGARLOAF…     24.7     -<span style="color: #BB0000;">81.2</span>    31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">2</span>003 <span style="color: #BB0000;">NA</span>          US      FLORIDA   25-1… SUGARLOAF…     24.7     -<span style="color: #BB0000;">81.2</span>    31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">2</span>004 <span style="color: #BB0000;">NA</span>          US      FLORIDA   25-1… SUGARLOAF…     24.7     -<span style="color: #BB0000;">81.2</span>    31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">2</span>005 <span style="color: #BB0000;">NA</span>          US      FLORIDA   25-2… SUGARLOAF…     24.6     -<span style="color: #BB0000;">81.6</span>    31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">2</span>006 <span style="color: #BB0000;">NA</span>          US      FLORIDA   25-2… SUGARLOAF…     24.6     -<span style="color: #BB0000;">81.6</span>    31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">2</span>007 <span style="color: #BB0000;">NA</span>          US      FLORIDA   25-2… SUGARLOAF…     24.6     -<span style="color: #BB0000;">81.6</span>    31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>008 <span style="color: #BB0000;">NA</span>          US      FLORIDA   25-2… SUGARLOAF…     24.6     -<span style="color: #BB0000;">81.6</span>    31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 71 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2 more variables: obs_n &lt;dbl&gt;, total_spp &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use combined or non-combined species forms</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="search_species.html">search_species</a></span><span class="op">(</span><span class="st">"Sooty grouse"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     aou english                  french order family genus species unid_combined</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">2</span>971 Sooty Grouse             Tétra… Gall… Phasi… Dend… fuligi… TRUE         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">2</span>973 Blue Grouse (Dusky/Soot… Tétra… Gall… Phasi… Dend… obscur… TRUE         </span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">stratify</span><span class="op">(</span>by <span class="op">=</span> <span class="st">"bbs_usgs"</span>, species <span class="op">=</span> <span class="st">"Blue Grouse (Dusky/Sooty)"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 'bbs_usgs' (standard) stratification</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading BBS data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering to species Blue Grouse (Dusky/Sooty) (2973)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Stratifying data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Renaming routes...</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">birds_strata</span><span class="op">)</span> <span class="co"># Contains all Dusky, Sooty and unidentified</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1572</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="search_species.html">search_species</a></span><span class="op">(</span><span class="st">"Sooty grouse"</span>, combine_species_forms <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     aou english                  french order family genus species unid_combined</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">2</span>971 Sooty Grouse             Tétra… Gall… Phasi… Dend… fuligi… FALSE        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">2</span>973 unid. Dusky Grouse / So… unid … Gall… Phasi… Dend… obscur… FALSE        </span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">stratify</span><span class="op">(</span>by <span class="op">=</span> <span class="st">"bbs_usgs"</span>, species <span class="op">=</span> <span class="st">"unid. Dusky Grouse / Sooty Grouse"</span>,</span></span>
<span class="r-in"><span>              combine_species_forms <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 'bbs_usgs' (standard) stratification</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading BBS data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering to species unid. Dusky Grouse / Sooty Grouse (2973)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Stratifying data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Renaming routes...</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">birds_strata</span><span class="op">)</span> <span class="co"># Contains *only* unidentified</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 92</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stratify by a subset of an existing stratification</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">my_cws</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bbs_strata</span><span class="op">[[</span><span class="st">"bbs_cws"</span><span class="op">]</span><span class="op">]</span>, <span class="va">country_code</span> <span class="op">==</span> <span class="st">"CA"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">stratify</span><span class="op">(</span>by <span class="op">=</span> <span class="st">"bbs_cws"</span>, strata_custom <span class="op">=</span> <span class="va">my_cws</span>, species <span class="op">=</span> <span class="st">"Snowy Owl"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 'bbs_cws' (subset) stratification</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading BBS data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering to species Snowy Owl (3760)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Stratifying data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Combining BCR 7 and NS and PEI...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Renaming routes...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Omitting 105,811/124,900 route-years that do not match a stratum.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     To see omitted routes use `return_omitted = TRUE` (see ?stratify)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">my_bcr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bbs_strata</span><span class="op">[[</span><span class="st">"bcr"</span><span class="op">]</span><span class="op">]</span>, <span class="va">strata_name</span> <span class="op">==</span> <span class="st">"BCR8"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">stratify</span><span class="op">(</span>by <span class="op">=</span> <span class="st">"bcr"</span>, strata_custom <span class="op">=</span> <span class="va">my_bcr</span>,</span></span>
<span class="r-in"><span>              species <span class="op">=</span> <span class="st">"Yellow-rumped Warbler (all forms)"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 'bcr' (subset) stratification</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading BBS data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering to species Yellow-rumped Warbler (all forms) (6556)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Stratifying data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Renaming routes...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Omitting 123,410/124,900 route-years that do not match a stratum.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     To see omitted routes use `return_omitted = TRUE` (see ?stratify)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stratify by Custom stratification, using sf map object</span></span></span>
<span class="r-in"><span><span class="co"># e.g. with WBPHS stratum boundaries 2019</span></span></span>
<span class="r-in"><span><span class="co"># available: https://ecos.fws.gov/ServCat/Reference/Profile/142628</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">map</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="st">"../WBPHS_Stratum_Boundaries_2019"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>strata_name <span class="op">=</span> <span class="va">STRAT</span><span class="op">)</span> <span class="co"># stratify expects this column</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">stratify</span><span class="op">(</span>by <span class="op">=</span> <span class="st">"WBPHS_2019"</span>, strata_map <span class="op">=</span> <span class="va">map</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Brandon P.M. Edwards, Adam C. Smith, Steffi LaZerte.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

